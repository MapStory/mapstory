{% extends "site_base.html" %}
{% load webdesign %}
{% load i18n %}
{% load staticfiles %}
{% load base_tags %}
{% load mapstory_tags %}
{% load cache %}
{% load avatar_tags %}

{% block extra_head %}
<!--<link href="{{ STATIC_URL }}vendor/isotope/css/style.css" rel="stylesheet" />-->
<link href="{{ STATIC_URL }}mapstory/css/index.css" rel="stylesheet" />
{% endblock %}

{% block extra_script %}
{{ block.super }}
<script type="text/javascript" src="{{ STATIC_URL }}vendor/modernizr/modernizr.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}vendor/jquery.stellar/jquery.stellar.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}vendor/isotope/jquery.isotope.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}mapstory/js/index.js"></script>
<script type="text/javascript">
    // Fix placeholder text for Home Page Search
    HAYSTACK_SEARCH = "{{ HAYSTACK_SEARCH }}".toLowerCase() === "true";
    HAYSTACK_FACET_COUNTS = "{{ HAYSTACK_FACET_COUNTS }}".toLowerCase() === "true";
    CLIENT_RESULTS_LIMIT = {{ CLIENT_RESULTS_LIMIT }};
</script>
{% endblock %}

{% block middle %}
<div ng-controller="search_controller">
    <section id="topParallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Africa' }}); height: 600px;"></div>
    </section>

    <section class="slice" id="welcome" style="margin-top:-250px;">
        {% include "branding/index_welcome.html" %}
    </section>

    <!-- TODO: New categories must be implemented or the button queries will just return nothing -->
    <section class="slice">
        {% include "branding/index_sections.html" %}
    </section>

    <section class="slice">
        <div class="container">
            <div ng-if="results.length">
                <slick infinite="true" slides-to-show="4" autoplay="true" init-onload="true" data="results">
                    <div class="col-md-3" ng-repeat="item in results" style="right: -5px;">
                        {% verbatim %}
                        <a href="{{ item.detail_url}}"><img class="thumb img-responsive" ng-src="{{ item.thumbnail_url}}" style="border-width:1px; border-style:solid; border-color:grey;"/></a>
                        <h3><a href="{{ item.detail_url}}">{{ item.title}}</a></h3>
                        <h5 class="abstract">{{ item.abstract|limitTo:250  }}<a href="{{ item.detail_url}}"><i>...{% endverbatim %}{% trans "read more" %}{% verbatim %}</i></a></h5>
                        <h4><span class="owner">{{ item.owner.username}}</span></h4>
                        {% endverbatim %}
                    </div>
                </slick>
            </div>
        </div>
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax1' }});"></div>
    </section>

    <section class="slice" id="getstarted">
        {% include "branding/index_getstarted.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax1' }});"></div>
    </section>

    <section class="slice" id="getinvolved">
        {% include "branding/index_getinvolved.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax2' }});"></div>
    </section>

    <section class="slice" id="getskills">
        {% include "branding/index_getskills.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax3' }});"></div>
    </section>

    <section class="slice" id="thinkers">
        {% include "branding/index_thinkers.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax1' }});"></div>
    </section>

    <section class="slice" id="news">
        {% include "branding/index_news.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax2' }});"></div>
    </section>

    <section class="slice" id="community">
        {% include "branding/index_community.html" %}
    </section>

    <section class="parallax">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax3' }});"></div>
    </section>

    <section class="slice" id="sponsors">
        {% include "branding/index_sponsors.html" %}
    </section>

    <section class="parallax" style="margin-bottom:-40px;">
        <div data-stellar-background-ratio="0.5" data-stellar-vertical-offset="0" style="background-image: url({{ images|by_name:'Parallax1' }});"></div>
    </section>
</div></div>
{% endblock %}
